<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity4" layout:decorator="layout">
<body>
	<div class="top-bar clearfix" layout:fragment="page_header_container">
		<!-- Page-header start -->
		<div class="page-header card">
			<div class="row align-items-end">
				<div class="col-lg-8">
					<div class="page-header-title">
						<i class="fa fa-envira bg-c-blue"></i>
						<div class="d-inline">
							<h4>繝輔ぃ繝ｳ縺ｸ縺ｮ驟堺ｿ｡蠎�蜻翫��繝ｬ繝昴�ｼ繝�繧｣繝ｳ繧ｰ</h4>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
	<!-- Page-header end -->

	<!-- Page body start -->
	<div layout:fragment="page_body_container">
		<form th:method="post" th:action="@{/dsp/reportingList(reportType=1)}">
			<div class="card">
				<div class="card-block">
					<h4 class="sub-title">讀懃ｴ｢譚｡莉ｶ</h4>
					<div class="form-group row">
						<label class="col-sm-2 col-form-label text-right">譯井ｻｶ蜷�</label>
						<div class="col-sm-4" th:if="${#lists.isEmpty(dspAdReportInputForm.campaignIdList)}">
							<select class="searchable" multiple="multiple" th:field="${dspAdReportInputForm.campaignIdList}">
								<option th:each="object : ${dspCampaignDtoList}" th:value="${object.getCampaignId()}" th:text="${object.getCampaignName()}">譌･譛ｬ</option>
							</select>
						</div>
						<div class="col-sm-4" th:unless="${#lists.isEmpty(dspAdReportInputForm.campaignIdList)}" id="redraw">
							<select class="searchable" multiple="multiple" th:field="${dspAdReportInputForm.campaignIdList}">
								<option th:each="object : ${dspCampaignDtoList}" th:selected="${#lists.contains(dspAdReportInputForm.campaignIdList, object.getCampaignId())}" th:value="${object.getCampaignId()}" th:text="${object.getCampaignName()}">譌･譛ｬ</option>
							</select>
						</div>
					</div>
					<div class="form-radio">
						<div class="form-group row">
							<label class="col-sm-2 col-form-label text-right">譛滄俣</label>
							<div class="radio radio-inline col-sm-2 col-form-label" th:each="object : ${T(jp.acepro.haishinsan.enums.PeriodSet).values()}">
								<label> <input class="form-control" type="radio" th:value="${object.value}" th:field="${dspAdReportInputForm.period}" th:text="${object.label}" checked="checked" required="required"> <i class="helper"></i>
								</label>
							</div>
						</div>
					</div>
					<div class="form-group row" id="search">
						<div class="col-sm-2 text-right">
							<label class="col-form-label">髢句ｧ区律</label>
						</div>
						<div class="col-sm-2">
							<input type="date" max="9999-12-31" class="form-control" th:field="${dspAdReportInputForm.startDate}">
						</div>
						<div class="col-sm-2 text-right">
							<label class="col-form-label">邨ゆｺ�譌･</label>
						</div>
						<div class="col-sm-2">
							<input type="date" max="9999-12-31" class="form-control" th:field="${dspAdReportInputForm.endDate}">
						</div>
					</div>
					<div class="form-group row">
						<label class="col-sm-2 col-form-label text-right">陦ｨ遉ｺ蛻･</label>
						<div class="col-sm-10">
							<button class="btn btn-primary" type="submit" th:formmethod="post" sec:authorize="hasAuthority('DSP_REPORT_VIEW')" th:formaction="@{/dsp/reportingList(reportType=1)}">繝�繝舌う繧ｹ蛻･</button>
							<button class="btn btn-success" type="submit" th:formmethod="post" sec:authorize="hasAuthority('DSP_REPORT_VIEW')" th:formaction="@{/dsp/reportingList(reportType=2)}">譌･莉伜挨</button>
							<button class="btn btn-info" type="submit" th:formmethod="post" sec:authorize="hasAuthority('DSP_REPORT_VIEW')" th:formaction="@{/dsp/reportingList(reportType=4)}">繧ｯ繝ｪ繧ｨ繧､繝�繧｣繝門挨</button>
						</div>
					</div>
				</div>
			</div>

			<div th:if="${(reportType != null) && (reportType != '')} ">
				<div class="card">
					<div class="card-block">
						<h4 class="sub-title">繧ｰ繝ｩ繝�</h4>
						<div id="dsp_reporting" class="c3"></div>
					</div>
				</div>
				<div class="card">
					<div class="card-block">
						<h4 class="sub-title">繝�繝ｼ繧ｿ</h4>
						<div class="dt-responsive table-responsive">
							<table id="basicTable" class="table table-striped table-hover table-bordered nowrap" style="width: 100%;">
								<thead>
									<tr>

										<th>譯井ｻｶID</th>
										<th>譯井ｻｶ蜷�</th>
										<th th:if="${reportType}==4">繧ｯ繝ｪ繧ｨ繧､繝�繧｣繝門錐</th>
										<th th:if="${reportType}==2">蟇ｾ雎｡譌･</th>
										<th th:if="${reportType}==1">繝�繝舌う繧ｹ</th>
										<th>陦ｨ遉ｺ蝗樊焚</th>
										<th>繧ｯ繝ｪ繝�繧ｯ謨ｰ</th>
										<th>雋ｻ逕ｨ</th>
										<th>CTR</th>
										<th>CPC</th>
										<th>CPM</th>
									</tr>
								</thead>
								<tbody>
									<tr th:each="dspReportingDto : ${dspReportingDtoList}">
										<td th:text="*{dspReportingDto.campaignId}">156853</td>
										<td th:text="*{dspReportingDto.campaignName}">繧ｭ繝｣繝ｳ繝壹�ｼ繝ｳ1</td>
										<td th:text="*{dspReportingDto.creativeName}" th:if="${reportType}==4">1</td>
										<td th:text="*{dspReportingDto.date}" th:if="${reportType}==2">1</td>
										<td th:text="${T(jp.acepro.haishinsan.enums.DspDeviceType).of(__*{dspReportingDto.deviceType}__).label}" th:if="!${#lists.isEmpty(dspReportingDtoList)} and ${reportType}==1">1</td>
										<td th:text="*{dspReportingDto.impressionCount}+'蝗�'">1,000,000</td>
										<td th:text="*{dspReportingDto.clickCount}+'蝗�'">2323</td>
										<td th:text="*{dspReportingDto.price} + '蜀�'">112</td>
										<td th:if="!${#lists.isEmpty(dspReportingDtoList)}" th:text="*{dspReportingDto.ctr}+'%'">191</td>
										<td th:text="*{dspReportingDto.cpc}">191</td>
										<td th:text="*{dspReportingDto.cpm}">191</td>
									</tr>
								</tbody>
								<tfoot>
									<tr>
										<th>譯井ｻｶID</th>
										<th>譯井ｻｶ蜷�</th>
										<th th:if="${reportType}==4">繧ｯ繝ｪ繧ｨ繧､繝�繧｣繝門錐</th>
										<th th:if="${reportType}==2">蟇ｾ雎｡譌･</th>
										<th th:if="${reportType}==1">繝�繝舌う繧ｹ</th>
										<th>陦ｨ遉ｺ蝗樊焚</th>
										<th>繧ｯ繝ｪ繝�繧ｯ謨ｰ</th>
										<th>雋ｻ逕ｨ</th>
										<th>CTR</th>
										<th>CPC</th>
										<th>CPM</th>
									</tr>
								</tfoot>
							</table>
						</div>
						<div class="form-group row">
							<div class="col-sm-12 text-center">
								<button class="btn btn-success" sec:authorize="hasAuthority('DSP_REPORT_VIEW')" th:formaction="@{/dsp/download(reportType=${reportType})}" th:formmethod="post">CSV繝�繧ｦ繝ｳ繝ｭ繝ｼ繝�</button>
							</div>
						</div>

					</div>
				</div>
			</div>
		</form>
	</div>

	<!-- page body end -->

	<div layout:fragment="custom_resource_body">
		<script type="text/javascript">
			$(document).ready(function() {
				if ($('[id=period1]').prop('checked')) {
					$('[id=search]').hide();
				}
				if ($('[id=period2]').prop('checked')) {
					$('[id=search]').show();
				}
			});
			$(document).ready(function() {
				$('[name="period"]:radio').change(function() {
					if ($('[id=period1]').prop('checked')) {
						$('[id=search]').fadeOut();
					}
					if ($('[id=period2]').prop('checked')) {
						$('[id=search]').fadeIn();
					}
				});
			});
		</script>
		<script type="text/javascript" th:inline="javascript">
			window.onload = function() {
				/*<![CDATA[*/
				var chart = c3.generate({
					bindto : '#dsp_reporting',
					data : {
						x : 'x',
						columns : [
						/*[[${dspReportingGraphDto.reportType}]]*/,
						/*[[${dspReportingGraphDto.impressionCount}]]*/,
						/*[[${dspReportingGraphDto.clickCount}]]*/,
						/*[[${dspReportingGraphDto.price}]]*/,
						/*[[${dspReportingGraphDto.cpc}]]*/,
						/*[[${dspReportingGraphDto.cpm}]]*/,
						/*[[${dspReportingGraphDto.ctr}]]*/
						],
						type : 'bar',
						names : {
							impressionCount : '陦ｨ遉ｺ蝗樊焚',
							clickCount : '繧ｯ繝ｪ繝�繧ｯ蝗樊焚',
							price : '雋ｻ逕ｨ',
							cpc : 'CPC',
							cpm : 'CPM',
							ctr : 'CTR'
						},
						types : {
							cpc : 'line',
							cpm : 'line',
							ctr : 'line',
						}
					},
					axis : {
						x : {
							type : 'category',
						}
					},
				});
				/*]]>*/
			}
		</script>
	</div>
</body>
</html>